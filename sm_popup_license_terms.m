function sm_popup_license_terms(varargin)
global h
h.license_flag = 0; 
terms_use = fileread('SIMMEEG_TERMS_OF_USE.txt');
% terms_use = sprintf('TERMS OF USE\nName: SimMEEG Software\nDescription: The SimMEEG Software (the “Program”) is a software-based tool to provide users the ability to virtually simulate electromagnetic brain responses and project them to virtual sensors. The Program was developed by Dr. Anthony Herdman at The University of British Columbia.\nThe Program is provided to the Licensee for research, educational and non-commercial purposes only.\nCLINICAL USE ADVISORY –\nTHE PROGRAM IS AN EXPERIMENTAL TECHNOLOGY AND HAS NOT BEEN TESTED OR APPROVED FOR USE IN CONNECTION WITH ANY HUMAN CLINICAL USE.  THE PROGRAM AND ANY CONTENT OR OTHER INFORMATION CONTAINED IN THE PROGRAM, ACCESSED THROUGH THE PROGRAM OR PROVIDED BY THE PROGRAM IS FOR INFORMATIONAL PURPOSES ONLY AND IN NO WAY IS INTENDED TO SERVE AS A SUBSTITUTE FOR PROFESSIONAL MEDICAL ADVICE OR INTENDED TO PROVIDE ANY MEDICAL OR CLINICAL JUDGMENT OR INDIVIDUALIZED PATIENT CARE. THE LICENSEE SHOULD SEEK PROFESSIONAL MEDICAL ADVICE IN EVALUATING THE INFORMATION PROVIDED WITHIN THE PROGRAM. THE COPYRIGHT HOLDER ALSO RECOMMENDS THAT THE LICENSEE CONSULT WITH MEDICAL PROFESSIONALS FOR HEALTH EVALUATION, DIAGNOSTIC OR TREATMENT DECISIONS.\nThe following additional terms (“Additional Terms”) supplement and modify the GNU General Public License, Version 3 (“GPLv3”) applicable to the Program. In addition to the terms and conditions of the GPLv3, the Program is subject to the further restrictions below.\n1. Disclaimer of Warranty –\nSection 15 of the GPLv3 shall be deleted in its entirety and replaced with the following:\n“The Licensee acknowledges and agrees that the Program is being provided “as is” and that to the extent that the Program or any such updates, upgrades or enhancements to the Program are provided by or on behalf of the copyright holder to the Licensee, the following disclaimers of warranty and limitations of liability shall apply in connection therewith. The copyright holder does not: (a) warrant or guarantee that any content or other information contained in the the Program or accessed through the Program or provided by the Program is accurate or error free; (b) undertake to provide the Licensee with any maintenance or support services related to the Program, including, without limitation, any updates, upgrades or enhancements thereto; or (c) assume any obligation to obtain and update any content or information in the Program or accessed through the Program or provided by the Program.\nThe Licensee further acknowledges and agrees that: (i) the Program is intended for use only as a research and educational tool;  (ii) it is the sole responsibility of the Licensee to determine his/her application and use of the Program, (iii) the Program is not intended as a replacement for professional medical advice or a health professional’s medical and clinical judgment (iv) the copyright holder will not be responsible for any errors, misstatements, inaccuracies or omissions regarding the Program or any delays in or interruptions in use of the Program, (v) the copyright has no control of or responsibility for the Licensee''s use of the Program and has no knowledge of the specific or unique circumstances under which the Program or information provided by the Program may be used by the Licensee; and (vi) the Licensee assumes sole responsibility for any and all use of the Program including any use of any content or other information contained within the Program, accessed through the Program or provided by the Program.  Furthermore, the Licensee acknowledges that the Program is being provided WITHOUT REPRESENTATION OR WARRANTY OF ANY KIND.  BY WAY OF EXAMPLE AND NOT LIMITATION, THE COPYRIGHT HOLDER MAKES NO REPRESENTATIONS OR WARRANTIES OF COMMERCIAL UTILITY, TITLE, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE OR ANY OTHER WARRANTY, EXPRESS OR IMPLIED.  THE COPYRIGHT HOLDER MAKES NO REPRESENTATION THAT THE USE OF THE PROGRAM WILL NOT INFRINGE ANY PATENT, COPYRIGHT, TRADEMARK OR OTHER PROPERTY OR PROPRIETARY RIGHTS.”\n\n2. Limitation of Liability –\nSection 16 of the GPLv3 shall be deleted in its entirety and replaced with the following:\n“The copyright holder will not be liable to the Licensee or any other person or entity (including but not limited to persons treated by the Licensee or on behalf of the Licensee) for any liability, loss or damages caused or alleged to have been caused, either directly or indirectly, by the use of the Program.  Without limitation, in no event will the copyright holder be liable for any tort, personal injury, medical malpractice, misdiagnosis, death, product liability, loss of profit or data, or for special, indirect, consequential, incidental or punitive damages, however caused and regardless of the theory of liability, arising out of or related to the use of or inability to use the Program, even if the copyright holder has been advised of the possibility of such loss or damages.”\n\n3. Indemnification –\nTO THE FULLEST EXTENT PERMITTED BY LAW, THE LICNESEE AGREES TO INDEMNIFY, DEFEND AND HOLD HARMLESS THE COPYRIGHT HOLDER AND ITS BOARD OF GOVERNORS, OFFICERS, DIRECTORS, FACULTY, STUDENTS, EMPLOYEES AND AGENTS (COLLECTIVELY THE "INDEMNITEES") FROM AND AGAINST ALL CLAIMS, ACTIONS LIABILITIES, LOSSES, EXPENSES, DAMAGES AND COSTS (INCLUDING, WITHOUT LIMITATION, REASONABLE LEGAL FEES) ("CLAIMS") THAT MAY AT ANY TIME BE INCURRED BY ANY OF THEM BY REASON OF ANY CLAIMS, SUITS OR PROCEEDINGS ARISING FROM (A) THE LICENSEE’S USE OF THE PROGRAM OR BY ANY OTHER PARTY AUTHORIZED BY THE LICENSEE, AND (B) ANY BREACH BY THE LICENSEE OF ANY REPRESENTATION, CONDITION OR TERM OF THIS LICENSE AGREEMENT.  WITHOUT LIMITATION, THIS INDEMNITY SHALL INCLUDE ANY CLAIMS BROUGHT BY THIRD PARTIES AGAINST THE INDEMNITEES IN TORT, OR FOR PERSONAL INJURY, MEDICAL MALPRACTICE, MISDIAGNOSIS, DEATH, PRODUCT LIABILITY, LOSS OF PROFIT OR DATA, OR FOR SPECIAL, INDIRECT, CONSEQUENTIAL, INCIDENTAL OR PUNITIVE DAMAGES, HOWEVER CAUSED AND REGARDLESS OF THE THEORY OF LIABILITY, ARISING OUT OF OR RELATED TO THE LICENSEE''S USE OF, OR INABILITY TO USE, THE PROGRAM.\n\n4. Trade-Marks and Names –\nThe Licensee will not use the name, logo, or trade-marks of the copyright holder or make reference to the copyright holder or its name in any advertising or publicity, without the prior written consent of the copyright holder.  The name of the copyright holder, or any other party who modifies or conveys the Program, shall not be used to endorse or promote products derived from the Program without express written permission. \n');
% delete(hf)
hf = figure('Name','SimMEEG: TERMS OF USE','Units','normalized','Position',[.1 .1 .5 .5]); 
x = uicontrol(hf,'style','edit','max',100,'Units','normalized','Position',[.1 .2 .8 .65],'string',sprintf('%s',terms_use),'Enable','inactive','FontSize',8,'HorizontalAlignment','center');

%% Button: Accept or Deny
ut1 = uicontrol(hf,'style','text','Units','normalized','Position',[x.Position(1) sum(x.Position([2 4]))+.01 x.Position(3) .125],...
    'String',sprintf('Citation for SimMEEG : Herdman, A.T. (2021) Journal of Neuroscience Methods.\n\nRed all "TERMS OF USE" by scrolling down\nselect ACCEPT or DECLINE'),...
    'FontSize',10,'HorizontalAlignment','center');
ut2 = uicontrol(hf,'style','text','Units','normalized','Position',[x.Position(1) x.Position(2)-.07 x.Position(3) .05],...
    'String','Do you agree to the Terms of Use for SimMEEG?','FontSize',10);
btn_accept = uicontrol(hf,'BackgroundColor',[.8 1 .8],'ForegroundColor',[0 0 0],'Style','pushbutton','Units','normalize',...
    'Tag','Accept','Position',[.35 .065 .12 .05],'Visible','on','UserData',1,...
    'FontSize',10,'HorizontalAlignment','center','String','ACCEPT','Callback',@btn_pressed);
btn_deny = uicontrol(hf,'BackgroundColor',[1 .8 .8],'ForegroundColor',[0 0 0],'Style','pushbutton','Units','normalize',...
    'Tag','Decline','Position',[.525 .065 .12 .05],'Visible','on','UserData',1,...
    'FontSize',10,'HorizontalAlignment','center','String','DECLINE','Callback',@btn_pressed);
waitfor(hf);

function btn_pressed(src,~)
global h

switch  src.Tag
    case 'Accept'
        h.license_flag = 1;
        close(gcf);
    case 'Decline'
       h.license_flag = 0; 
        close(gcf);
end



